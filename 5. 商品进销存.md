### 商品进销存模块数据库设计

#### 1. 商品分类表
```sql
CREATE TABLE `fa_fzly_product_category` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `name` varchar(100) NOT NULL COMMENT '分类名称',
  `parent_id` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '父分类ID',
  `level` tinyint(3) unsigned NOT NULL DEFAULT 1 COMMENT '分类级别',
  `sort` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '排序',
  `status` enum('normal','hidden') NOT NULL DEFAULT 'normal' COMMENT '状态',
  `createtime` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '创建时间',
  `updatetime` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '更新时间',
  PRIMARY KEY (`id`),
  KEY `parent_id` (`parent_id`),
  KEY `status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='商品分类表';

-- 插入测试数据
INSERT INTO `fa_fzly_product_category` (`name`, `parent_id`, `level`, `sort`, `status`, `createtime`, `updatetime`) VALUES
('纪念品', 0, 1, 1, 'normal', UNIX_TIMESTAMP(), UNIX_TIMESTAMP()),
('零食', 0, 1, 2, 'normal', UNIX_TIMESTAMP(), UNIX_TIMESTAMP()),
('优惠券', 0, 1, 3, 'normal', UNIX_TIMESTAMP(), UNIX_TIMESTAMP()),
('钥匙扣', 1, 2, 1, 'normal', UNIX_TIMESTAMP(), UNIX_TIMESTAMP()),
('巧克力', 2, 2, 1, 'normal', UNIX_TIMESTAMP(), UNIX_TIMESTAMP());
```

#### 2. 供应商表
```sql
CREATE TABLE `fa_fzly_supplier` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `name` varchar(100) NOT NULL COMMENT '供应商名称',
  `contact_person` varchar(50) NOT NULL COMMENT '联系人',
  `contact_phone` varchar(20) NOT NULL COMMENT '联系电话',
  `address` varchar(255) DEFAULT '' COMMENT '地址',
  `remark` text COMMENT '备注',
  `status` enum('normal','hidden') NOT NULL DEFAULT 'normal' COMMENT '状态',
  `createtime` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '创建时间',
  `updatetime` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '更新时间',
  PRIMARY KEY (`id`),
  KEY `status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='供应商表';

-- 插入测试数据
INSERT INTO `fa_fzly_supplier` (`name`, `contact_person`, `contact_phone`, `address`, `status`, `createtime`, `updatetime`) VALUES
('纪念品供应商', '张三', '13800138001', '北京市朝阳区', 'normal', UNIX_TIMESTAMP(), UNIX_TIMESTAMP()),
('食品供应商', '李四', '13900139001', '上海市浦东新区', 'normal', UNIX_TIMESTAMP(), UNIX_TIMESTAMP());
```

#### 3. 商品表
```sql
CREATE TABLE `fa_fzly_product` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `category_id` int(10) unsigned NOT NULL COMMENT '分类ID',
  `supplier_id` int(10) unsigned NOT NULL COMMENT '供应商ID',
  `name` varchar(100) NOT NULL COMMENT '商品名称',
  `sn` varchar(50) NOT NULL COMMENT '商品编号',
  `image` varchar(255) DEFAULT '' COMMENT '商品图片',
  `price` decimal(10,2) NOT NULL DEFAULT 0.00 COMMENT '销售单价',
  `purchase_price` decimal(10,2) NOT NULL DEFAULT 0.00 COMMENT '采购单价',
  `spec` varchar(100) DEFAULT '' COMMENT '规格',
  `unit` varchar(20) NOT NULL COMMENT '单位',
  `type` enum('physical','virtual') NOT NULL DEFAULT 'physical' COMMENT '商品类型：physical=实物，virtual=虚拟',
  `status` enum('normal','hidden') NOT NULL DEFAULT 'normal' COMMENT '状态',
  `remark` text COMMENT '备注',
  `createtime` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '创建时间',
  `updatetime` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '更新时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `sn` (`sn`),
  KEY `category_id` (`category_id`),
  KEY `supplier_id` (`supplier_id`),
  KEY `status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='商品表';

-- 插入测试数据
INSERT INTO `fa_fzly_product` (`category_id`, `supplier_id`, `name`, `sn`, `image`, `price`, `purchase_price`, `spec`, `unit`, `type`, `status`, `createtime`, `updatetime`) VALUES
(4, 1, '景区logo钥匙扣', 'JNP001', '', 39.90, 15.00, '10cm*5cm', '个', 'physical', 'normal', UNIX_TIMESTAMP(), UNIX_TIMESTAMP()),
(5, 2, '景区限定巧克力', 'LS001', '', 29.90, 10.00, '100g', '盒', 'physical', 'normal', UNIX_TIMESTAMP(), UNIX_TIMESTAMP()),
(3, 1, '门票优惠券', 'YHQ001', '', 50.00, 0.00, '满200减50', '张', 'virtual', 'normal', UNIX_TIMESTAMP(), UNIX_TIMESTAMP());
```

#### 4. 库存表
```sql
CREATE TABLE `fa_fzly_stock` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `product_id` int(10) unsigned NOT NULL COMMENT '商品ID',
  `quantity` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '当前库存数量',
  `locked_quantity` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '锁定库存数量',
  `warn_quantity` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '库存预警数量',
  `createtime` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '创建时间',
  `updatetime` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '更新时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `product_id` (`product_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='库存表';

-- 插入测试数据
INSERT INTO `fa_fzly_stock` (`product_id`, `quantity`, `locked_quantity`, `warn_quantity`, `createtime`, `updatetime`) VALUES
(1, 100, 5, 20, UNIX_TIMESTAMP(), UNIX_TIMESTAMP()),
(2, 50, 0, 10, UNIX_TIMESTAMP(), UNIX_TIMESTAMP()),
(3, 200, 10, 50, UNIX_TIMESTAMP(), UNIX_TIMESTAMP());
```

#### 5. 采购订单表
```sql
CREATE TABLE `fa_fzly_purchase_order` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `order_sn` varchar(50) NOT NULL COMMENT '订单编号',
  `supplier_id` int(10) unsigned NOT NULL COMMENT '供应商ID',
  `total_amount` decimal(10,2) NOT NULL DEFAULT 0.00 COMMENT '订单总金额',
  `purchase_time` int(10) unsigned DEFAULT 0 COMMENT '采购时间',
  `arrival_time` int(10) unsigned DEFAULT 0 COMMENT '到货时间',
  `status` enum('pending','received','cancelled') NOT NULL DEFAULT 'pending' COMMENT '状态：pending=待收货，received=已收货，cancelled=已取消',
  `remark` text COMMENT '备注',
  `operate_id` int(10) unsigned NOT NULL COMMENT '操作人ID',
  `operate_name` varchar(50) NOT NULL COMMENT '操作人姓名',
  `createtime` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '创建时间',
  `updatetime` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '更新时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `order_sn` (`order_sn`),
  KEY `supplier_id` (`supplier_id`),
  KEY `status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='采购订单表';

-- 插入测试数据
INSERT INTO `fa_fzly_purchase_order` (`order_sn`, `supplier_id`, `total_amount`, `purchase_time`, `status`, `operate_id`, `operate_name`, `createtime`, `updatetime`) VALUES
('CG20240701001', 1, 1500.00, UNIX_TIMESTAMP(), 'pending', 1, 'admin', UNIX_TIMESTAMP(), UNIX_TIMESTAMP()),
('CG20240701002', 2, 1000.00, UNIX_TIMESTAMP(), 'received', 1, 'admin', UNIX_TIMESTAMP(), UNIX_TIMESTAMP());
```

#### 6. 采购订单明细表
```sql
CREATE TABLE `fa_fzly_purchase_order_item` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `order_id` int(10) unsigned NOT NULL COMMENT '订单ID',
  `product_id` int(10) unsigned NOT NULL COMMENT '商品ID',
  `quantity` int(10) unsigned NOT NULL COMMENT '采购数量',
  `price` decimal(10,2) NOT NULL COMMENT '采购单价',
  `amount` decimal(10,2) NOT NULL COMMENT '金额',
  `received_quantity` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '已收货数量',
  `createtime` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '创建时间',
  `updatetime` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '更新时间',
  PRIMARY KEY (`id`),
  KEY `order_id` (`order_id`),
  KEY `product_id` (`product_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='采购订单明细表';

-- 插入测试数据
INSERT INTO `fa_fzly_purchase_order_item` (`order_id`, `product_id`, `quantity`, `price`, `amount`, `received_quantity`, `createtime`, `updatetime`) VALUES
(1, 1, 100, 15.00, 1500.00, 0, UNIX_TIMESTAMP(), UNIX_TIMESTAMP()),
(2, 2, 100, 10.00, 1000.00, 100, UNIX_TIMESTAMP(), UNIX_TIMESTAMP());
```

#### 7. 销售订单表
```sql
CREATE TABLE `fa_fzly_sales_order` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `order_sn` varchar(50) NOT NULL COMMENT '订单编号',
  `channel` enum('ticket_window','restaurant','online') NOT NULL COMMENT '销售渠道：ticket_window=售票窗口，restaurant=餐饮，online=线上',
  `total_amount` decimal(10,2) NOT NULL DEFAULT 0.00 COMMENT '订单总金额',
  `status` enum('pending','completed','cancelled') NOT NULL DEFAULT 'pending' COMMENT '状态：pending=待完成，completed=已完成，cancelled=已取消',
  `remark` text COMMENT '备注',
  `operate_id` int(10) unsigned DEFAULT 0 COMMENT '操作人ID',
  `operate_name` varchar(50) DEFAULT '' COMMENT '操作人姓名',
  `createtime` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '创建时间',
  `updatetime` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '更新时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `order_sn` (`order_sn`),
  KEY `channel` (`channel`),
  KEY `status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='销售订单表';

-- 插入测试数据
INSERT INTO `fa_fzly_sales_order` (`order_sn`, `channel`, `total_amount`, `status`, `operate_id`, `operate_name`, `createtime`, `updatetime`) VALUES
('XS20240701001', 'ticket_window', 69.80, 'completed', 1, 'admin', UNIX_TIMESTAMP(), UNIX_TIMESTAMP()),
('XS20240701002', 'restaurant', 29.90, 'completed', 1, 'admin', UNIX_TIMESTAMP(), UNIX_TIMESTAMP());
```

#### 8. 销售订单明细表
```sql
CREATE TABLE `fa_fzly_sales_order_item` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `order_id` int(10) unsigned NOT NULL COMMENT '订单ID',
  `product_id` int(10) unsigned NOT NULL COMMENT '商品ID',
  `quantity` int(10) unsigned NOT NULL COMMENT '销售数量',
  `price` decimal(10,2) NOT NULL COMMENT '销售单价',
  `amount` decimal(10,2) NOT NULL COMMENT '金额',
  `createtime` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '创建时间',
  `updatetime` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '更新时间',
  PRIMARY KEY (`id`),
  KEY `order_id` (`order_id`),
  KEY `product_id` (`product_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='销售订单明细表';

-- 插入测试数据
INSERT INTO `fa_fzly_sales_order_item` (`order_id`, `product_id`, `quantity`, `price`, `amount`, `createtime`, `updatetime`) VALUES
(1, 1, 1, 39.90, 39.90, UNIX_TIMESTAMP(), UNIX_TIMESTAMP()),
(1, 2, 1, 29.90, 29.90, UNIX_TIMESTAMP(), UNIX_TIMESTAMP()),
(2, 2, 1, 29.90, 29.90, UNIX_TIMESTAMP(), UNIX_TIMESTAMP());
```

#### 9. 库存变动记录表
```sql
CREATE TABLE `fa_fzly_stock_change_log` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `product_id` int(10) unsigned NOT NULL COMMENT '商品ID',
  `type` enum('purchase','sale','adjust','check') NOT NULL COMMENT '变动类型：purchase=采购入库，sale=销售出库，adjust=调整，check=盘点',
  `related_id` int(10) unsigned NOT NULL COMMENT '关联ID（订单ID或盘点ID等）',
  `quantity` int(11) NOT NULL COMMENT '变动数量（正数为增加，负数为减少）',
  `before_quantity` int(10) unsigned NOT NULL COMMENT '变动前库存',
  `after_quantity` int(10) unsigned NOT NULL COMMENT '变动后库存',
  `remark` text COMMENT '备注',
  `operate_id` int(10) unsigned NOT NULL COMMENT '操作人ID',
  `operate_name` varchar(50) NOT NULL COMMENT '操作人姓名',
  `createtime` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '创建时间',
  PRIMARY KEY (`id`),
  KEY `product_id` (`product_id`),
  KEY `type` (`type`),
  KEY `createtime` (`createtime`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='库存变动记录表';

-- 插入测试数据
INSERT INTO `fa_fzly_stock_change_log` (`product_id`, `type`, `related_id`, `quantity`, `before_quantity`, `after_quantity`, `operate_id`, `operate_name`, `createtime`) VALUES
(1, 'sale', 1, -1, 101, 100, 1, 'admin', UNIX_TIMESTAMP()),
(2, 'sale', 1, -1, 51, 50, 1, 'admin', UNIX_TIMESTAMP()),
(2, 'purchase', 2, 100, 0, 100, 1, 'admin', UNIX_TIMESTAMP());
```

#### 10. 盘点记录表
```sql
CREATE TABLE `fa_fzly_stock_check` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `check_sn` varchar(50) NOT NULL COMMENT '盘点编号',
  `check_time` int(10) unsigned NOT NULL COMMENT '盘点时间',
  `status` enum('pending','completed') NOT NULL DEFAULT 'pending' COMMENT '状态：pending=进行中，completed=已完成',
  `remark` text COMMENT '备注',
  `operate_id` int(10) unsigned NOT NULL COMMENT '操作人ID',
  `operate_name` varchar(50) NOT NULL COMMENT '操作人姓名',
  `createtime` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '创建时间',
  `updatetime` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '更新时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `check_sn` (`check_sn`),
  KEY `status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='盘点记录表';

-- 插入测试数据
INSERT INTO `fa_fzly_stock_check` (`check_sn`, `check_time`, `status`, `operate_id`, `operate_name`, `createtime`, `updatetime`) VALUES
('PD20240701001', UNIX_TIMESTAMP(), 'completed', 1, 'admin', UNIX_TIMESTAMP(), UNIX_TIMESTAMP());
```

#### 11. 盘点明细记录表
```sql
CREATE TABLE `fa_fzly_stock_check_item` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键ID',
  `check_id` int(10) unsigned NOT NULL COMMENT '盘点ID',
  `product_id` int(10) unsigned NOT NULL COMMENT '商品ID',
  `system_quantity` int(10) unsigned NOT NULL COMMENT '系统库存数量',
  `actual_quantity` int(10) unsigned NOT NULL COMMENT '实际盘点数量',
  `diff_quantity` int(11) NOT NULL COMMENT '差异数量',
  `remark` varchar(255) DEFAULT '' COMMENT '差异原因',
  `createtime` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '创建时间',
  `updatetime` int(10) unsigned NOT NULL DEFAULT 0 COMMENT '更新时间',
  PRIMARY KEY (`id`),
  KEY `check_id` (`check_id`),
  KEY `product_id` (`product_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='盘点明细记录表';

-- 插入测试数据
INSERT INTO `fa_fzly_stock_check_item` (`check_id`, `product_id`, `system_quantity`, `actual_quantity`, `diff_quantity`, `remark`, `createtime`, `updatetime`) VALUES
(1, 1, 100, 99, -1, '丢失一个', UNIX_TIMESTAMP(), UNIX_TIMESTAMP()),
(1, 2, 50, 50, 0, '', UNIX_TIMESTAMP(), UNIX_TIMESTAMP()),
(1, 3, 200, 205, 5, '找到之前丢失的', UNIX_TIMESTAMP(), UNIX_TIMESTAMP());
```

### CRUD命令生成

```bash
# 商品分类
php think crud -t fa_fzly_product_category -c fzly/product_category -m fzly/ProductCategory -u 1

# 供应商
php think crud -t fa_fzly_supplier -c fzly/supplier -m fzly/Supplier -u 1

# 商品
php think crud -t fa_fzly_product -c fzly/product -m fzly/Product -u 1

# 库存
php think crud -t fa_fzly_stock -c fzly/newstock -m fzly/NewStock -u 1

# 采购订单
php think crud -t fa_fzly_purchase_order -c fzly/purchase_order -m fzly/PurchaseOrder -u 1

# 采购订单明细
php think crud -t fa_fzly_purchase_order_item -c fzly/purchase_order_item -m fzly/PurchaseOrderItem -u 1

# 销售订单
php think crud -t fa_fzly_sales_order -c fzly/sales_order -m fzly/SalesOrder -u 1

# 销售订单明细
php think crud -t fa_fzly_sales_order_item -c fzly/sales_order_item -m fzly/SalesOrderItem -u 1

# 库存变动记录
php think crud -t fa_fzly_stock_change_log -c fzly/stock_change_log -m fzly/StockChangeLog -u 1

# 盘点记录
php think crud -t fa_fzly_stock_check -c fzly/stock_check -m fzly/StockCheck -u 1

# 盘点明细记录
php think crud -t fa_fzly_stock_check_item -c fzly/stock_check_item -m fzly/StockCheckItem -u 1
```

以上数据库设计覆盖了商品进销存模块的所有核心功能点，包括商品管理、采购管理、销售关联、库存盘点和数据关联。生成的CRUD命令将创建对应的控制器、模型和视图文件，遵循FastAdmin框架规范，控制器文件会生成在`admin\controller\fzly\`目录下，模板文件会生成在`admin\view\fzly\`目录下。

页面风格会自动继承FastAdmin框架的默认风格，与参考页面保持一致的UI设计规范。